import rdkit.Chem.PandasTools
from rdkit import Chem
from rdkit.Chem import Draw
from rdkit.Chem.Draw import IPythonConsole
from molecular_rectifier import Rectifier
import prolif as plf



database=Chem.SDMolSupplier("file_path_for_database.sdf",removeHs=False)
#convert into PDB individual files
count=0
for mol in database:
    count=count+1
  
    try:

        Chem.MolToPDBFile(mol,(str(count)+".pdb"))
    except:
        print(count)

#convert in rdkit mole database
data=[]
for i in range (1,12136):
    lig = Chem.MolFromPDBFile("".join([str(i),".pdb"]),removeHs=False,sanitize=False)
    print (i)
    data.append(lig)
    
#read protein structure

prot1 = Chem.MolFromPDBFile("Cfile_path_to_protein1.pdb", removeHs=False)
prot2 = Chem.MolFromPDBFile("Cfile_path_to_protein2.pdb", removeHs=False)

Draw.MolsToGridImage(data)

#do interaction calculations
data_mol=[plf.molecule.Molecule(x) for x in data]
prot_mol1=plf.molecule.Molecule(prot1)
prot_mol2=plf.molecule.Molecule(prot2)
fp1 = plf.Fingerprint()
fp1.run_from_iterable(data_mol, prot_mol1)
fp2 = plf.Fingerprint()
fp2.run_from_iterable(data_mol, prot_mol2)

#save interaction finger print as csv files
df1 = fp1.to_dataframe()
df2 = fp2.to_dataframe()
df1.to_csv('interaction_fingerprints_for_protein1.csv')
df2.to_csv('interaction_fingerprints_for_protein2.csv')
df
